<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>STOCK MANUAL GUDANG G5000</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f4f4f4;
        }
        h1 {
            text-align: center;
        }
        form {
            background: white;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
        }
        select, input[type="number"], input[type="text"], button {
            width: 100%;
            padding: 10px;
            margin-top: 5px;
        }
        button {
            background-color: #28a745;
            color: white;
            border: none;
            cursor: pointer;
        }
        button:hover {
            background-color: #218838;
        }
        #history {
            margin-top: 20px;
            background: white;
            padding: 10px;
            border-radius: 5px;
            max-height: 300px;
            overflow-y: auto;
        }
    </style>
</head>
<body>

<h1>STOCK MANUAL GUDANG G5000</h1>
<form id="stockForm">
    <div class="form-group">
        <label for="productType">Pilih Jenis Produk:</label>
        <select id="productType" required>
            <option value="">-- Pilih --</option>
            <option value="SEMEN">SEMEN</option>
            <option value="BESI">BESI</option>
            <option value="BWG">BWG - KAWAT DURI</option>
            <option value="GALVALUM">GALVALUM - BONDEX</option>
        </select>
    </div>
    <div class="form-group">
        <label for="productName">Pilih Nama Produk:</label>
        <select id="productName" required>
            <option value="">-- Pilih --</option>
        </select>
    </div>
    <div class="form-group">
        <label for="quantity">Jumlah Barang:</label>
        <input type="number" id="quantity" required>
    </div>
    <div class="form-group">
        <label for="checkerName">Nama Checker:</label>
        <input type="text" id="checkerName" required>
    </div>
    <button type="button" onclick="submitStock('in')">Barang Masuk</button>
    <button type="button" onclick="submitStock('out')">Barang Keluar</button>
    <button type="reset">Reset</button>
</form>

<div id="history"></div>

<script>
    // Data produk berdasarkan jenis
    const products = {
        SEMEN: ["SEMEN TIGA RODA 50 KG", "SEMEN TONASA 50 KG", "SEMEN PUTIH JAGUAR 40 KG", "SB PEREKAT BATA RINGAN 40 KG"],
        BESI: ["KAWAT 8 (DELAPAN)", "KAWAT 10 (SEPULUH)", "KAWAT 12 (DUA BELAS)", "KAWAT 8.4 X 12", "KAWAT 25 (DUA PULUH LIMA) ULIR", "KAWAT 19 (SEMBILAN BELAS) ULIR", "KAWAT 22 (DUA PULUH DUA) ULIR", "KAWAT 13 (TIGA BELAS) ULIR", "KAWAT 7.1 X 12", "KAWAT 16 (ENAM BELAS)", "KAWAT 16 (ENAM BELAS) ULIR", "KAWAT 14 (EMPAT BELAS)", "KAWAT 11.4 X 12", "KAWAT 4.7 X 12", "KAWAT 10 (SEPULUH) ULIR", "KAWAT 6 (ENAM)"],
        BWG: ["BENDRAT PUTIH ROL (25 KG)", "BENDRAT PUTIH ROL (20 KG)", "BWG 12", "BWG 14", "BWG 16", "BWG 6", "BWG 8", "KAWAT DURI BIASA", "KAWAT DURI 100M (ANTI KARAT)", "LIS KAYU 4X4", "BENDRAT STIK 20 KG", "BWG 10"],
        GALVALUM: ["GALVALUM KENCANA (0.25) 4 M", "GALVALUM KENCANA (0.3) 4 M", "GALVALUM KENCANA (0.35) 4 M", "GALVALUM SOLID (0.3) 4 M"]
    };

    // Menangani perubahan jenis produk
    document.getElementById('productType').addEventListener('change', function() {
        const productNameSelect = document.getElementById('productName');
        productNameSelect.innerHTML = '<option value="">-- Pilih --</option>'; // Reset pilihan nama produk
        const selectedType = this.value;
        if (products[selectedType]) {
            products[selectedType].forEach(product => {
                const option = document.createElement('option');
                option.value = product;
                option.textContent = product;
                productNameSelect.appendChild(option);
            });
        }
    });

    // Fungsi untuk menyimpan data ke Google Sheets
    function submitStock(type) {
        const productType = document.getElementById('productType').value;
        const productName = document.getElementById('productName').value;
        const quantity = document.getElementById('quantity').value;
        const checkerName = document.getElementById('checkerName').value;

        if (productType && productName && quantity && checkerName) {
            const label = getLabel(productType);
            const historyEntry = `Waktu Input: ${new Date().toLocaleString()} - ${type === 'in' ? 'Barang Masuk' : 'Barang Keluar'} - ${productName} (${quantity} ${label}) oleh ${checkerName}`;
            document.getElementById('history').innerHTML += `<div>${historyEntry}</div>`;

            // Kirim data ke Google Sheets
            fetch('https://script.google.com/macros/s/AKfycbxlf1kOKQyOC1jh5iRiQf0arb8skjKkWfnBBXW8DNaRPRzFPQ96AnhuyjqMcBfiKQ7VYQ/exec', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    type: type,
                    productType: productType,
                    productName: productName,
                    quantity: quantity,
                    checkerName: checkerName
                })
            })
            .then(response => response.json())
            .then(data => {
                console.log('Success:', data);
            })
            .catch((error) => {
                console.error('Error:', error);
            });
        } else {
            alert('Semua field harus diisi!');
        }
    }

    // Fungsi untuk mendapatkan label berdasarkan jenis produk
    function getLabel(productType) {
        switch (productType) {
            case 'SEMEN':
            case 'BWG':
                return 'sak';
            case 'BESI':
            case 'LIS KAYU':
            case 'BENDRAT STIK':
                return 'batang';
            case 'GALVALUM':
                return 'lembar';
            default:
                return '';
        }
    }
</script>

</body>
</html>
